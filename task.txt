
Задание

Необходимо реализовать часть сервиса аутентификации. Сервис должен предоставлять четыре конечные точки API:
    на получение пары токенов (access и refresh) для пользователя с идентификатором (GUID) указанным в параметре запроса;
    на обновление пары токенов;
    на получение GUID текущего пользователя (роут должен быть защищен);
    на деавторизацию пользователя (поле выполнения этого запроса с access токеном, пользователю больше не должен быть доступен роут на получение его GUID и операция обновления токенов).

Требования
Требования к access токену:
    Формат токена - JWT,
    Алгоритм для подписи токена - SHA512,
    Хранить токен в базе строго запрещено.

Требования к refresh токену
    Формат токена - произвольный.
    Передаваться токен должен только в формате base64.
    Хранить токен в базе строго в виде bcrypt хеша.
    Токен должен быть защищен от повторного использования.
    Токен должен быть защищен от изменений на стороне клиента.

Требования к операции refresh
    Операцию refresh можно выполнить только той парой токенов, которая была выдана вместе.
    Необходимо запретить операцию обновления токенов при изменении User-Agent. При этом, после неудачной попытки выполнения операции, неоходимо деавторизовать пользователя, который попытался выполнить обновление токенов.
    При попытке обновления токенов с нового IP необходимо отправить POST-запрос на заданный webhook с информацией о попытке входа со стороннего IP. Запрещать операцию в данном случае не нужно.
